# Story 4.1: ุตูุฏูู ูุงุฑุฏ ุงูุทูุจุงุช ููุฃุฏูู โ ุญุงูุฉ ุงูุฅููุงู

**ุงูุชุงุฑูุฎ:** 2025-11-08  
**ุงูุญุงูุฉ:** โ ููุชูู

---

## โ ูุง ุชู ุฅูุฌุงุฒู

### 1. API `GET /admin/requests`
- ุฅูุดุงุก ูุณุงุฑ ุฌุฏูุฏ ูู `admin.routes.ts` ูุญูู ุจู `authenticate` ู `requirePermission('admin.requests.review')`.
- ุฅุถุงูุฉ `adminRequestController.listRequests` ููุชุญูู ูู ุตูุงุญูุฉ ุงูุฃุฏููุ ุงูุชุญูู ูู ูุนุงููุงุช ุงูุงุณุชุนูุงู ุจุงุณุชุฎุฏุงู Zodุ ูุฅุฑุฌุงุน ุงููุชุงุฆุฌ/ุงูุฃุฎุทุงุก ุจุตูุบุฉ ููุญุฏุฉ.
- ุชูููุฐ ุฎุฏูุฉ `listAdminRequests` ุงูุชู ุชุณุชุฎุฏู Supabase JS ูููุฑุงุกุฉ ูู ุฌุฏูู `requests` ูุน ุงูุถูุงูุงุช (joins) ูู `users` ู`investor_profiles` ููุญุตูู ุนูู ุจูุงูุงุช ุงููุณุชุซูุฑ.

### 2. ุฏุนู ุงูููุชุฑุฉ ูุงููุฑุฒ ูุงูุจุญุซ
- ููุชุฑุฉ ุญุณุจ ุงูุญุงูุฉุ ููุน ุงูุทูุจ (ุดุฑุงุก/ุจูุน)ุ ูุทุงู ุงููุจูุบุ ูุงููุทุงู ุงูุฒููู (`created_at`).
- ุงูุจุญุซ ุจุงูุฑูู ุฃู ุงุณู/ุงูุงุณู ุงูููุถู ูููุณุชุซูุฑ ุจุงุณุชุฎุฏุงู `.or()` ู`ilike`.
- ูุฑุฒ ุญุณุจ ุงูุชุงุฑูุฎ ุฃู ุงููุจูุบ ุฃู ุงูุญุงูุฉุ ูุน ุฏุนู ุงุชุฌุงู ุงูุตุนูุฏ/ุงููุจูุท.
- Pagination ุนุจุฑ `.range()` ูุน ุงุญุชุณุงุจ ุฅุฌูุงูู ุงูุณุฌูุงุช (`count: 'exact'`).

### 3. ููุงุฐุฌ ุงูุชุญูู
- ุชุนุฑูู `adminRequestListQuerySchema` (Zod) ูู `backend/src/schemas/admin-requests.schema.ts` ูุถูุงู ุตุญุฉ ูุนุงููุงุช ุงูุงุณุชุนูุงู (page, limit, status, type, amount, dateุ ุฅูุฎ).
- ุงุณุชุฎุฏุงู ุงูุฏูุงู ุงููุณุงุนุฏุฉ ููุชุญููู ุฅูู ุฃุฑูุงู/ุชูุงุฑูุฎ ูุงูุชุฃูุฏ ูู ุตุญุฉ ุงูุฅุฏุฎุงู ูุจู ุงุณุชุฏุนุงุก ุงูุฎุฏูุฉ.

### 4. ุงูุงุฎุชุจุงุฑุงุช
- **ุฎุฏูุฉ:** `backend/tests/admin-request.service.test.ts` ุชุบุทู:
  - ุฎุฑูุทุฉ ุงููุชุงุฆุฌ ุฅูู ูููู ููุญุฏ (ูุน ุจูุงูุงุช ุงููุณุชุซูุฑ).
  - ุงูุชุญูู ูู ุงุณุชุฏุนุงุก ููุงุชุฑ Supabase ุจุงููุนุงููุงุช ุงูุตุญูุญุฉ.
  - ุงูุชุนุงูู ูุน ุฃุฎุทุงุก Supabase.
- **ูููุชุฑููุฑ:** `backend/tests/admin-request.controller.test.ts` ุชุบุทู:
  - ุณููุงุฑููุงุช ุนุฏู ุงููุตุงุฏูุฉ/ุงูุชุญูู ูู ุงููุฏุฎูุงุช.
  - ูุฌุงุญ ุงูุงุณุชุฌุงุจุฉ.
  - ุฃุฎุทุงุก ุบูุฑ ูุชููุนุฉ ูุฅุฑุฌุงุน HTTP 500.

---

## ๐งช ุงูุงุฎุชุจุงุฑุงุช
- **Lint:** `npm run lint`
- **Unit Tests:**  
  ```bash
  npm run test -- --runTestsByPath backend/tests/admin-request.controller.test.ts backend/tests/admin-request.service.test.ts
  ```

---

## ๐ ุงููููุงุช ุงููุชุฃุซุฑุฉ
- `backend/src/schemas/admin-requests.schema.ts`
- `backend/src/services/admin-request.service.ts`
- `backend/src/controllers/admin-request.controller.ts`
- `backend/src/routes/admin.routes.ts`
- `backend/tests/admin-request.service.test.ts`
- `backend/tests/admin-request.controller.test.ts`
- ุงููุณุชูุฏ ุงูุญุงูู `docs/stories/STORY_4.1_COMPLETION.md`

---

## ๐ ููุงุญุธุงุช
- ูุชู ุฅูุดุงุก ุฑูุงุจุท ุงูุชูุฒูู ูููุฑููุงุช ูู ูุตุต ูุงุญูุฉ (Story 3.4/4.3)ุ ูุฐู ุงููุตุฉ ุชุฑูุฒ ููุท ุนูู ูุงุฆูุฉ ุงูุทูุจุงุช.
- ูุนุชูุฏ ูุฑุจุน ุงููุงุฑุฏ ููุฃุฏูู ุนูู RLS ูุตูุงุญูุฉ `admin.requests.review` ูุถูุงู ุงููุตูู ุงูุตุญูุญ.
- ูููู ุชูุณูุน ุงูุฎุฏูุฉ ูุงุญููุง ูุฏุนู ุฃุนูุฏุฉ ุฅุถุงููุฉ (ูุซู ุขุฎุฑ ุญุฏุซ ุฃู ุนูุงูุงุช ุงูุฌุฏุฉ) ุญุณุจ ูุชุทูุจุงุช ูุงุฌูุฉ Story 4.2.

---

**ุชู ุงูุฅูุดุงุก ุจูุงุณุทุฉ:** GPT-5 Codex (Cursor)  
**ุขุฎุฑ ุชุญุฏูุซ:** 2025-11-08  

