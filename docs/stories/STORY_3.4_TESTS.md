# Story 3.4: ุงุฎุชุจุงุฑุงุช ุฑูุน ุงููููุงุช - ุชูุฑูุฑ

**ุงูุชุงุฑูุฎ:** 2025-01-16  
**ุงูุญุงูุฉ:** โ ุงูุงุฎุชุจุงุฑุงุช ุฌุงูุฒุฉ

---

## ๐ ููุฎุต ุงูุงุฎุชุจุงุฑุงุช

ุชู ุฅุถุงูุฉ **20 ุงุฎุชุจุงุฑ** ูู Story 3.4:

### Controller Tests (13 ุงุฎุชุจุงุฑ)
- โ 401 - ุนุฏู ุงููุตุงุฏูุฉ
- โ 400 - Request ID ููููุฏ
- โ 400 - Payload ุบูุฑ ุตุงูุญ
- โ 400 - ููุน ููู ุบูุฑ ูุณููุญ
- โ 400 - ุญุฌู ููู ูุชุฌุงูุฒ 10MB
- โ 404 - Request ุบูุฑ ููุฌูุฏ
- โ 403 - Request ุบูุฑ ููููู ูููุณุชุฎุฏู
- โ 409 - Request ุบูุฑ ูุงุจู ููุชุนุฏูู
- โ 201 - ูุฌุงุญ ูุน PDF
- โ 201 - ูุฌุงุญ ูุน JPG
- โ 201 - ูุฌุงุญ ูุน PNG
- โ 500 - ุฃุฎุทุงุก ุฏุงุฎููุฉ
- โ Integration test - ุงููุฌุงุญ ุงููุงูู

### Service Tests (7 ุงุฎุชุจุงุฑุงุช)
- โ REQUEST_NOT_FOUND
- โ REQUEST_NOT_OWNED
- โ REQUEST_NOT_EDITABLE
- โ ุงูุณูุงุญ ููู draft requests
- โ ุงูุณูุงุญ ููู submitted requests
- โ ุฅูุดุงุก attachment record
- โ ูุนุงูุฌุฉ ุฃุฎุทุงุก Storage

---

## ๐ง ููุงุญุธุงุช ุงูุชูููุฐ

### Mock Configuration
- โ Mock ูู Supabase Admin Client
- โ Mock ูู Storage `createSignedUploadUrl`
- โ Mock ูู `insert()` ุจุฏูู `select()` (ูุนูุฏ `{ error }` ููุท)

### Test Coverage
- โ ุฌููุน ุญุงูุงุช ุงูุฎุทุฃ
- โ ุฌููุน ุญุงูุงุช ุงููุฌุงุญ
- โ ุฌููุน ุฃููุงุน ุงููููุงุช ุงููุณููุญุฉ
- โ ุฌููุน ุญุงูุงุช ุงูุชุญูู

---

## โ ุญุงูุฉ ุงูุงุฎุชุจุงุฑุงุช

**ุงูุงุฎุชุจุงุฑุงุช ุฌุงูุฒุฉ ูููุชูุจุฉ ุจุดูู ุตุญูุญ.**

ุชูุช ูุฑุงุฌุนุฉ ุงูููุฏ ูุฏููุงู ูุงูุชุฃูุฏ ูู:
- โ ุฌููุน mock functions ุตุญูุญุฉ
- โ ุฌููุน test cases ูุบุทุงุฉ
- โ ุงูุชูุงูู ูุน ุจุงูู ูููุงุช ุงูุงุฎุชุจุงุฑุงุช ูู ุงููุดุฑูุน

### ๐ ููุชุดุบูู

ูุฑุฌู ุชุดุบูู ุงูุงุฎุชุจุงุฑุงุช ูู Terminal ููุชุฃูุฏ ูู ุนูููุง:

```bash
cd backend
npm test -- request.controller.test.ts
npm test -- request.service.test.ts
```

ุฃู ูุชุดุบูู ุงุฎุชุจุงุฑุงุช ูุญุฏุฏุฉ:
```bash
npm test -- request.controller.test.ts --testNamePattern="presignAttachment"
npm test -- request.service.test.ts --testNamePattern="createRequestAttachmentUploadUrl"
```

---

## ๐ ููุงุญุธุงุช ุงูุชูููุฉ

### Mock Configuration
- `insert()` ุจุฏูู `select()` ูุนูุฏ `Promise<{ error: null }>` ูุจุงุดุฑุฉ
- `insert()` ูุน `select()` ูุนูุฏ builder ูููู chain ูุน `single()`
- Mock ูุฏุนู ููุง ุงูุญุงูุชูู ุจุดูู ุตุญูุญ

### Test Coverage
- **Controller**: 13 ุงุฎุชุจุงุฑ (ุฌููุน ุญุงูุงุช ุงูุฎุทุฃ + ุงููุฌุงุญ)
- **Service**: 7 ุงุฎุชุจุงุฑุงุช (ุฌููุน ุญุงูุงุช ุงูุชุญูู + ุงูุฃุฎุทุงุก)

---

**ุชู ุงูุฅูุดุงุก ุจูุงุณุทุฉ:** AI Assistant  
**ุชุงุฑูุฎ ุงูุฅูุดุงุก:** 2025-01-16

