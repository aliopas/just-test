# Story 4.6: ุฅุถุงูุฉ ุชุนูููุงุช ุฏุงุฎููุฉ โ ุญุงูุฉ ุงูุฅููุงู

**ุงูุชุงุฑูุฎ:** 2025-11-08  
**ุงูุญุงูุฉ:** โ ููุชูู

---

## โ ูุง ุชู ุฅูุฌุงุฒู

### 1. ูุงุนุฏุฉ ุงูุจูุงูุงุช
- ุฅูุดุงุก ุฌุฏูู `request_comments` ุนุจุฑ ุงููุฌุฑุฉ `20241108090000_request_comments.sql` ูุชุฎุฒูู ุชุนูููุงุช ุงูุฃุฏูู ุงูุฏุงุฎููุฉ (ูุน `request_id`, `actor_id`, `comment`, `created_at`).
- ุชูุนูู RLS ูุฅุถุงูุฉ ุณูุงุณุฉ ุฅุฏุงุฑุฉ (ูุน ุงูุงุนุชูุงุฏ ุนูู ุตูุงุญูุงุช ุงูุฎุฏูุฉ ููุฑุงุกุฉ ุฌููุน ุงูุชุนูููุงุช).
- ููุงุฑุณ ูููุฑุงุกุฉ ุงูุณุฑูุนุฉ ุญุณุจ ุงูุทูุจ ูุงููุณุชุฎุฏู.

### 2. ูุงุฌูุงุช ุงูู API
- ุชูุณูุน `admin-request.service.ts` ุจุฅุฌุฑุงุกุงุช:
  - `listAdminRequestComments` ูุฌูุจ ุงูุชุนูููุงุช ูุน ุจูุงูุงุช ุงููุงุชุจ.
  - `addAdminRequestComment` ูุฅุถุงูุฉ ุชุนููู ุฌุฏูุฏ ูุน ุชุทุจูุน ุงูุจูุงูุงุช ูุชุณุฌูููุง ูู `audit_logs` ุชุญุช ุงูุญุฏุซ `request.comment_added`.
- ุชุญุฏูุซ `getAdminRequestDetail` ูุฏูุฌ ุงูุชุนูููุงุช ุงูุฌุฏูุฏุฉ ุถูู ุงุณุชุฌุงุจุฉ ุงูุชูุงุตูู.
- ุฅุถุงูุฉ ููุงูุงุช ุฌุฏูุฏุฉ ูู `admin-request.controller.ts` ู `admin.routes.ts`:
  - `GET /admin/requests/:id/comments`
  - `POST /admin/requests/:id/comments`
- ุญูุงูุฉ ุงููุณุงุฑุงุช ุนุจุฑ `authenticate` ู `requirePermission('admin.requests.review')`.

### 3. ุงููุงุฌูุฉ ุงูุฃูุงููุฉ
- ุชุญุฏูุซ `AdminRequestDetailPage` ูุนุฑุถ ุงูุชุนูููุงุช ุงูุฏุงุฎููุฉ ูุน ุชูุงุตูู ุงููุงุชุจ ูุงูุทุงุจุน ุงูุฒููู.
- ุฅุถุงูุฉ ูููุฐุฌ ูุฅุฑุณุงู ุชุนููู ุฏุงุฎูู ุฌุฏูุฏ (ูุน ุญุฏ ุฃูุตู 2000 ุญุฑูุ Toasts ูููุฌุงุญ/ุงููุดูุ ูุฅุนุงุฏุฉ ุชุญููู ุชููุงุฆูุฉ).
- ุชุญุฏูุซ ุงูุชุฑุฌูุฉ ูู `frontend/src/locales/adminRequests.ts` ูุฅุถุงูุฉ ูุตูุต ุงูุฅุฌุฑุงุกุงุช ุงูุฌุฏูุฏุฉ ูุฑุณุงุฆู ุงูุชูุฌูู.
- ุฏุนู ุนุฑุถ ุงุณู ุงููุงุชุจ (ุงูุงุณู ุงูููุถู ุซู ุงููุงูู ุซู ุงูุจุฑูุฏ) ูุน ุจุฏูู ูู ุญุงู ุบูุงุจ ุงูุจูุงูุงุช.

### 4. ุฃููุงุน ูููุงุฐุฌ
- ุชุญุฏูุซ `frontend/src/types/admin.ts` ูุชุนุฑูู `AdminRequestCommentActor` ูุงุญุชูุงุก ุชูุงุตูู ุงููุงุชุจ ูู ุงูุชุนูููุงุช.
- ููุงูุจุฉ ุงูุชุบููุฑุงุช ูู ุงูุฎุฏูุงุช/ุงูุงุฎุชุจุงุฑุงุช ูุถูุงู ุงูุชูุงูู ูุน ุงูุดูู ุงูุฌุฏูุฏ.

---

## ๐งช ุงูุงุฎุชุจุงุฑุงุช
- `npm run lint`
- `npm run test -- --runTestsByPath backend/tests/admin-request.controller.test.ts backend/tests/admin-request.service.test.ts`

---

## ๐ ุงููููุงุช ุงููุชุฃุซุฑุฉ
- `supabase/migrations/20241108090000_request_comments.sql`
- `backend/src/services/admin-request.service.ts`
- `backend/src/controllers/admin-request.controller.ts`
- `backend/src/routes/admin.routes.ts`
- `backend/tests/admin-request.service.test.ts`
- `backend/tests/admin-request.controller.test.ts`
- `backend/src/services/notification.service.ts`
- `frontend/src/types/admin.ts`
- `frontend/src/locales/adminRequests.ts`
- `frontend/src/pages/AdminRequestDetailPage.tsx`
- `docs/front-end-spec.md`
- `README.md`
- ุงููุณุชูุฏ ุงูุญุงูู `docs/stories/STORY_4.6_COMPLETION.md`

---

## ๐ ููุงุญุธุงุช
- ุฅุดุนุงุฑุงุช ุงูุชุนูููุงุช ูุง ุชุฒุงู Placeholder ูุญูู ุชูุนูู ูููุงุช ุงูุชูุจูู ุงููุนููุฉ.
- ุงูุชุนูููุงุช ุฏุงุฎููุฉ ููุง ุชูุนุฑุถ ูููุณุชุซูุฑุ ุงูุฃุญุฏุงุซ ุงููุณุชูุจููุฉ ูุฏ ุชูุธูุฑ ุฑุฏูุฏ ุงููุณุชุซูุฑ ูู ุชุฏููุงุช ูุงุญูุฉ.
- ุชู ุงูุชุฃูุฏ ูู ุชุณุฌูู ูู ุชุนููู ูู `audit_logs` ูุน ูููุฉ ุงููุงุชุจุ ููุง ูุณูู ุงูุชุชุจุน.

---

**ุชู ุงูุฅูุดุงุก ุจูุงุณุทุฉ:** GPT-5 Codex (Cursor)  
**ุขุฎุฑ ุชุญุฏูุซ:** 2025-11-08  

