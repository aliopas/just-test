# ุฎุทุฉ ุงุฎุชุจุงุฑ ุฅุตูุงุญ ุทูุจุงุช ุงูุดุฑุงูุฉ
# Testing Plan for Partnership Request Fix

## โ๏ธ ููุงุญุธุฉ ูููุฉ
## Important Note

**ูู ูุชู ุงูุชุญูู ูุนููุงู ูู ุญู ุงููุดููุฉ ุจุนุฏ.** ูุฐุง ุงูููู ูุญุฏุฏ ุฎุทูุงุช ุงูุงุฎุชุจุงุฑ ุงููุทููุจุฉ.

**The issue has not been actually verified as fixed yet.** This file outlines the required testing steps.

---

## ๐ ุงูุฎุทูุงุช ุงููุทููุจุฉ ููุชุญูู
## Required Steps to Verify

### โ ุงูุฎุทูุฉ 1: ุงูุชุญูู ูู ุฃู `generate_request_number()` ุชุนูู
### Step 1: Verify `generate_request_number()` Works

**ุงูุชุญูู ุงูุญุงูู:**
**Current Status:**

```sql
-- ุชู ุงุฎุชุจุงุฑ ุงูุฏุงูุฉ - ุชุนูู ุจุดูู ุตุญูุญ โ
SELECT generate_request_number();
-- ุงููุชูุฌุฉ: INV-2025-000027, INV-2025-000028, INV-2025-000029 โ
```

**โ ุชู ุงูุชุญูู:** ุงูุฏุงูุฉ ุชุนูู ุจุดูู ุตุญูุญ ุจุนุฏ ุงูุฅุตูุงุญ

---

### โ ุงูุฎุทูุฉ 2: ุงุฎุชุจุงุฑ ุฅูุดุงุก ุทูุจ ุดุฑุงูุฉ ูุนููุงู
### Step 2: Actually Test Creating a Partnership Request

**ูุฐู ุงูุฎุทูุฉ ูู ูุชู ุชูููุฐูุง ุจุนุฏ.**
**This step has NOT been executed yet.**

**ุงูุฎุทูุงุช ุงููุทููุจุฉ:**
**Required Steps:**

1. **ุฅุฑุณุงู ุทูุจ ุดุฑุงูุฉ ูู ุงููุงุฌูุฉ:**
   - ุงูุชุญ ุงูุชุทุจูู
   - ุงุฐูุจ ุฅูู ุตูุญุฉ ุฅูุดุงุก ุทูุจ ุดุฑุงูุฉ
   - ุงููุฃ ุฌููุน ุงูุญููู ุงููุทููุจุฉ
   - ุฃุฑุณู ุงูุทูุจ

2. **ูุฑุงูุจุฉ ุงููุชูุฌุฉ:**
   - โ **ูุฌุญ:** ูุฌุจ ุฃู ูุธูุฑ ุฑุณุงูุฉ ูุฌุงุญ
   - โ **ูุดู:** ูุฌุจ ุฃู ูุธูุฑ ุฎุทุฃ 500

3. **ุฅุฐุง ูุดูุ ุชุญูู ูู:**
   - Netlify Function Logs
   - Browser Network Tab
   - Error message

---

### โ ุงูุฎุทูุฉ 3: ุงูุชุญูู ูู ุงูุณุฌูุงุช
### Step 3: Check Logs

**ูุฐู ุงูุฎุทูุฉ ูู ูุชู ุชูููุฐูุง ุจุนุฏ.**
**This step has NOT been executed yet.**

**ุงูุชุญูู ูู:**

1. **Netlify Function Logs:**
   - ุงุฐูุจ ุฅูู Netlify Dashboard
   - Functions โ server โ Logs
   - ุงุจุญุซ ุนู:
     - `Request body received:`
     - `Validation successful:`
     - `Creating request with payload:`
     - ุฃู ุฃุฎุทุงุก

2. **Browser Network Tab:**
   - F12 โ Network
   - ุงุจุญุซ ุนู `POST /api/v1/investor/requests`
   - ุชุญูู ูู:
     - Request payload
     - Response status (200/201 vs 500)
     - Response body

---

### โ ุงูุฎุทูุฉ 4: ุงูุชุญูู ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
### Step 4: Verify Database

**ูุฐู ุงูุฎุทูุฉ ูู ูุชู ุชูููุฐูุง ุจุนุฏ.**
**This step has NOT been executed yet.**

**ุจุนุฏ ุฅุฑุณุงู ุงูุทูุจ (ุฅุฐุง ูุฌุญ):**

```sql
-- ุชุญูู ูู ุฃู ุงูุทูุจ ุชู ุฅูุดุงุคู
SELECT 
  id,
  request_number,
  type,
  status,
  amount,
  currency,
  metadata,
  created_at
FROM requests
WHERE type = 'partnership'
ORDER BY created_at DESC
LIMIT 1;
```

**ุงููุชูุฌุฉ ุงููุชููุนุฉ:**
- โ ูุฌุจ ุฃู ูุธูุฑ ุงูุทูุจ ุงูุฌุฏูุฏ
- โ `request_number` ูุฌุจ ุฃู ูููู ููุฌูุฏุงู
- โ `metadata` ูุฌุจ ุฃู ูุญุชูู ุนูู ุงูุจูุงูุงุช

---

## ๐ ุงููุดุงูู ุงููุญุชููุฉ ุงููุชุจููุฉ
## Potential Remaining Issues

ุญุชู ูู ุชู ุฅุตูุงุญ `generate_request_number()`ุ ูุฏ ุชููู ููุงู ูุดุงูู ุฃุฎุฑู:

Even if `generate_request_number()` is fixed, there might be other issues:

### 1. ูุดููุฉ ูู ูุนุงูุฌุฉ Metadata
### Metadata Processing Issue

- ูุฏ ุชููู ุงูุจูุงูุงุช ูุง ุชูุฑุณู ุจุดูู ุตุญูุญ ูู Frontend
- ูุฏ ุชููู ููุงู ูุดููุฉ ูู validation
- ูุฏ ุชููู ููุงู ูุดููุฉ ูู ุชูุธูู ุงูุจูุงูุงุช

### 2. ูุดููุฉ ูู Validation Schema
### Validation Schema Issue

- ูุฏ ูุง ูุชุทุงุจู schema ูู Frontend ูุน Backend
- ูุฏ ุชููู ููุงู ุญููู ููููุฏุฉ ุฃู ุบูุฑ ุตุญูุญุฉ

### 3. ูุดููุฉ ูู ุฅุฏุฑุงุฌ ุงูุจูุงูุงุช
### Database Insert Issue

- ูุฏ ุชููู ููุงู ูุดููุฉ ูู ุงููููุฏ (constraints)
- ูุฏ ุชููู ููุงู ูุดููุฉ ูู Foreign Keys
- ูุฏ ุชููู ููุงู ูุดููุฉ ูู RLS policies

---

## โ ูุงุฆูุฉ ุงูุชุญูู ุงูููุงุฆูุฉ
## Final Checklist

- [ ] โ ุชู ุฅุตูุงุญ `generate_request_number()` - ุชู ุงูุชุญูู
- [ ] โ ุชู ุงุฎุชุจุงุฑ ุฅูุดุงุก ุทูุจ ุดุฑุงูุฉ ูุนููุงู - **ูู ูุชู ุจุนุฏ**
- [ ] โ ุชู ุงูุชุญูู ูู ุงูุณุฌูุงุช - **ูู ูุชู ุจุนุฏ**
- [ ] โ ุชู ุงูุชุญูู ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช - **ูู ูุชู ุจุนุฏ**
- [ ] โ ุชู ุงูุชุฃูุฏ ูู ุฃู ุงูุฎุทุฃ 500 ูู ูุนุฏ ููุฌูุฏุงู - **ูู ูุชู ุจุนุฏ**

---

## ๐ฏ ุงูุฎุทูุงุช ุงูุชุงููุฉ
## Next Steps

### ูุฌุจ ุชูููุฐ ูุฐู ุงูุฎุทูุงุช ุจุงูุชุฑุชูุจ:

1. **ุฅุฑุณุงู ุทูุจ ุดุฑุงูุฉ ูุนููุงู**
   - ุงุณุชุฎุฏู ุงููุงุฌูุฉ ูุฅุฑุณุงู ุทูุจ ุดุฑุงูุฉ
   - ุฑุงูุจ ุงููุชูุฌุฉ

2. **ุฅุฐุง ูุฌุญ:**
   - โ ุงููุดููุฉ ุชู ุญููุง
   - ุชุญูู ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช ููุชุฃูุฏ

3. **ุฅุฐุง ูุดู (ูุง ูุฒุงู ุฎุทุฃ 500):**
   - ุงูุชุญ Netlify Function Logs
   - ุงูุชุญ Browser Network Tab
   - ุฃุฑุณู ูู:
     - ุฑุณุงุฆู ุงูุฎุทุฃ ูู Netlify
     - Request/Response ูู Network Tab
     - ุฃู ูุนูููุงุช ุฅุถุงููุฉ

---

## ๐ ููุงุญุธุงุช
## Notes

- **ุงูุฅุตูุงุญุงุช ุงูุชู ุชูุช:** ุชู ุฅุตูุงุญ ุฌููุน ุงูุฏูุงู ูุฅุถุงูุฉ `SET search_path`
- **ุงูุชุญูู:** ุชู ุงูุชุญูู ูู ุฃู `generate_request_number()` ุชุนูู
- **ุงูุงุฎุชุจุงุฑ ุงููุนูู:** ูู ูุชู ุจุนุฏ - **ูุทููุจ**

---

**ุขุฎุฑ ุชุญุฏูุซ:** 2025-01-30
**Last Updated:** 2025-01-30

