## خطة تطوير صفحة تفاصيل أخبار المستثمرين

- **الملف المستهدف**: `frontend/src/spa-pages/InvestorNewsDetailPage.tsx`
- **وصف قصير**: صفحة لعرض تفاصيل خبر للمستثمرين مع دعم تعدد اللغات (عربي/إنجليزي) واتجاه النص (RTL/LTR).

---

## 1. تحسين تجربة المستخدم (UX/UI)

- **حالة التحميل (Loading)**
  - [ ] استبدال نص التحميل بعرض Skeleton (أماكن رمادية للعناوين والمتن) لزيادة إحساس السرعة.
  - [ ] توحيد مظهر حالة التحميل مع باقي صفحات التطبيق (إن وجدت مكوّنات جاهزة للـ Skeleton).

- **حالة الخطأ (Error)**
  - [ ] إضافة زر "إعادة المحاولة" في حالة الخطأ إذا كان الـ hook `useInvestorNewsDetail` يدعم `refetch`.
  - [ ] عرض رسالة خطأ أكثر وضوحًا (مثلاً: مشكلة في الاتصال، الرجاء المحاولة لاحقًا).

- **حالة عدم وجود بيانات (No Data)**
  - [ ] إضافة حالة عندما تكون `!isLoading && !isError && !data` لعرض رسالة أن الخبر غير موجود أو تم حذفه.
  - [ ] إضافة خيار للعودة إلى قائمة الأخبار من هذه الحالة.

- **زر الرجوع (Back Button)**
  - [ ] إضافة أيقونة سهم (مثلاً `←` أو أيقونة من مكتبة الأيقونات المستخدمة).
  - [ ] في حال عدم وجود تاريخ تنقل مناسب (history)، إعادة التوجيه لصفحة قائمة الأخبار بدل `navigate(-1)` فقط.

---

## 2. تحسينات الكود والبنية

- **التعامل مع المعرّف `id`**
  - [ ] استخدام Typing أفضل مع `useParams` (مثلاً: `useParams<{ id?: string }>()`) بدل استخدام `as string | undefined`.
  - [ ] إضافة حماية في حال عدم وجود `id` (إظهار رسالة مناسبة أو إعادة التوجيه لصفحة الأخبار).

- **تنسيق التاريخ**
  - [ ] نقل دالة `formatDateTime` إلى ملف Utilities عام (مثلاً: `frontend/src/utils/date.ts`).
  - [ ] إعادة استخدام نفس الدالة في صفحات أخرى تحتاج لتنسيق التاريخ/الوقت.
  - [ ] إضافة تحقق من صلاحية التاريخ قبل العرض، مع fallback نصي في حال التاريخ غير صالح.

- **تنظيم الأنماط (Styles)**
  - [ ] تقليل استخدام `inline styles` ونقلها إلى:
    - مكوّنات Styled، أو
    - CSS Modules، أو
    - أي نظام تصميم/ستايل معتمد في المشروع.
  - [ ] إنشاء مكوّنات UI صغيرة قابلة لإعادة الاستخدام مثل:
    - [ ] `PageContainer`
    - [ ] `Card` لاحتواء تفاصيل الخبر
    - [ ] `BackButton`

---

## 3. تحسين منطق عرض الـ Markdown

- **المشكلة الحالية**
  - منطق يدوي لتفسير عناوين Markdown (`#`, `##`, ...) والقوائم البسيطة (`-`, `*`) فقط.
  - عدم دعم:
    - القوائم الرقمية (`1.`).
    - القوائم المتداخلة.
    - الجداول والروابط والنص المنسق (Bold/Italic).

- **خطة التطوير**
  - [ ] استبدال المنطق اليدوي بمكتبة `react-markdown` مع `remark-gfm` أو ما يماثلها.
  - [ ] تعريف مكوّنات مخصصة (components) لكل عنصر (مثل `p`, `h2`, `h3`, `ul`, `li`) لتطبيق ألوان وخطوط الـ theme الحالي.
  - [ ] ضبط مستويات العناوين داخل المتن:
    - [ ] استخدام `h2` بدل `h1` كأعلى مستوى داخل جسم الخبر.
    - [ ] استخدام `h3`, `h4` للمستويات الأدنى، للحفاظ على `h1` كعنوان الخبر الرئيسي فقط.

---

## 4. تحسينات الوصولية (Accessibility)

- **الهيكل الدلالي**
  - [ ] التأكد من وجود عنصر `<main>` في الـ layout العام للصفحة، أو إضافة `role="main"` عند الحاجة.
  - [ ] إضافة `aria-labelledby` لعنصر التفاصيل `section` يربطه بعنصر العنوان (عنوان الخبر).

- **اللغة والاتجاه**
  - [ ] التأكد أن قيمة `lang` في عنصر `<html>` تتغير مع `language` (ar/en) من خلال الـ layout أو الـ context.
  - [ ] إضافة `dir={direction}` على عناصر أقرب لمحتوى الـ article لضمان التوافق مع كل المتصفحات.

---

## 5. تطويرات مستقبلية مقترحة

- **مشاركة الخبر**
  - [ ] إضافة زر/مجموعة أزرار لمشاركة الخبر (WhatsApp, X/Twitter, LinkedIn) مع روابط تتضمن UTM parameters.

- **أخبار ذات صلة**
  - [ ] إضافة قسم أسفل تفاصيل الخبر لعرض "أخبار ذات صلة" بناءً على:
    - نفس التصنيف (إن كان متوفرًا من الـ API).
    - أو كلمات مفتاحية مرتبطة.

- **تحليلات (Analytics)**
  - [ ] إرسال حدث (Event) عند فتح صفحة تفاصيل الخبر (مثلاً: `investor_news_view`) لقياس الأخبار الأكثر قراءة.

- **تحسين الأداء للمحتوى الطويل**
  - [ ] في حال كان `bodyMd` طويلًا جدًا، إضافة:
    - [ ] خاصية "عرض المزيد/عرض أقل" لأجزاء من النص.
    - [ ] أو استخدام `IntersectionObserver` لتحميل أجزاء لاحقًا عند الـ scroll إن احتاج الأمر.

---

## 6. أولويات التنفيذ المقترحة

1. **أمان البيانات وحالات العرض**  
   - حالات `error`, `no data`, وحماية `id`.
2. **تحسين Markdown**  
   - اعتماد مكتبة متخصصة وتعديل مستويات العناوين.
3. **تحسين UX/UI الأساسي**  
   - Skeleton للتحميل، زر الرجوع المحسّن.
4. **تنظيم الكود والستايلات**  
   - نقل الأنماط لمكوّنات/ملفات مشتركة.
5. **التطويرات المستقبلية (مشاركة، أخبار ذات صلة، Analytics)**  
   - بناءً على أولوية المنتج والوقت المتاح.


